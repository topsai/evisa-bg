{% extends "sb2/base.html" %}
{% block css %}
{% endblock %}
{% block content %}

   <style>
        .indexbox {
            width: 100%;
            margin: 0 auto;
        }

        .index_input {
            width: 200px;
        }

        .maxbutton {
            border-radius: 90px;
        }

        .sum-index {
            text-align: center;
        }

        ul {
            padding: 0;
            margin: 0;
            list-style: none;
        }

        .infobox {
            width: 100%;
        }
        input::-webkit-input-placeholder{
            font-size:0.8rem;
        }
        input::-moz-placeholder{   /* Mozilla Firefox 19+ */
            font-size:0.8rem;
        }
        input:-moz-placeholder{    /* Mozilla Firefox 4 to 18 */
           font-size:0.8rem;
        }
        input:-ms-input-placeholder{  /* Internet Explorer 10-11 */
            font-size:0.8rem;
        }
        textarea{
            font-size:0.8rem;
        }
        .infobox li {
            border: 1px solid #f90;
            font-size: 12px;
            width: 33%;
            float: left;
        }

        .row-img {
            width: 49%;
            height: 7rem;
            border: 1px dotted #ccc;
            margin-bottom: 1rem !important;
        }

        .row-p {
            text-align: center;
        }

        .text-primary {
            color: #999 !important;
        }

        .card-header {
            color: #4e73df !important;
        }
        .img-size{
          font-size:2rem;
        }
        #prompt3 {
         width: 100%;
          height: 180px;
          text-align: center;
          position: relative;
        }
        #imgSpan {
         position: absolute;
        top: 20px;
        left: 45%;
        text-align: center;
        }
        .filepath {
         width: 100%;
         height: 40%;
         opacity: 0;
        }
        #img3 {
         height: 100%;
         width: 100%;
         display: none;
        }
        .info-btn{
          position: absolute; top:0; right: 0;
        }
        .over{position: relative;}
        #finish{
          display: block;
        }
        .info-hot{
            color:indianred;
        }
        label{
            margin-bottom:1.5rem;
        }
        /*.card-header{
          background:#d9edf7;
        }*/
    </style>



    {#    粘贴进来的文件sta  #}
    <div id="content-wrapper">

        <div class="container-fluid indexbox">

            <!-- Breadcrumbs-->
            {#        <div class="card-header">#}
            {#            <i class="fas fa-table"></i>#}
            {#            签注进度查询#}
            {#        </div>#}
        <div class="card mb-3">
        <div class="card-header">
            <i class="fas fa-table"></i>
            基本资料
        </div>
        <!-- 标题栏 end-->

        <div class="card-body">
            <p class="mb-0 small info-hot">*接受文件类型:pdf,jpg,jpeg,png,bmp，请确保文件大小大于100KB，小于2MB</p>
            <div class="row">
                <!-- Grow In Utility -->
                <div class="col-lg-4">

                    <div class="card position-relative">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">上传护照副本</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="small mb-6 row-img over">
                                      <!-- <i class="fa fa-camera-retro img-size"></i><br/> -->
                                   <div id="imgPreview">
                                     <div id="prompt3">
                                     <span id="imgSpan">
                                     <i class="fa fa-camera-retro img-size"></i>
                                       <br />
                                     </span>
                                     <input name="passportphoto[]" value="1111" type="file" id="file" class="filepath" onchange="changepic(this)" accept="image/jpg,image/jpeg,image/png,image/PNG">
                                     <p>上传护照(封面)</p>
                                     </div>
                                     <img src="#" id="img3" />
                                    </div>

                                    <button id="finish" type="button" class="btn  btn-circle btn-success info-btn"><i class="fa fa-check"></i>
                            </button>
                                </div>

                                <div class="small mb-6 row-img over">
                                  <div id="imgPreview">
                                     <div id="prompt3">
                                     <span id="imgSpan">
                                     <i class="fa fa-camera-retro img-size"></i>
                                       <br />
                                       <!--AUI框架中的图标-->
                                     </span>
                                     <input name="passportphoto[]" value="1111" type="file" id="file" class="filepath" onchange="changepic(this)" accept="image/jpg,image/jpeg,image/png,image/PNG">
                                     <p>上传护照(个人信息页)</p>
                                     </div>
                                    </div>

                                    <button id="finish" type="button" class="btn  btn-circle btn-success info-btn"><i class="fa fa-check"></i></button>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4">
                  <div class="card position-relative">
                      <div class="card-header py-3">
                          <h6 class="m-0 font-weight-bold text-primary">上传机票行程单</h6>
                      </div>
                      <div class="card-body">
                          <div class="row">
                              <div class="small mb-6 row-img over">
                                    <!-- <i class="fa fa-camera-retro img-size"></i><br/> -->
                                 <div id="imgPreview">
                                   <div id="prompt3">
                                   <span id="imgSpan">
                                   <i class="fa fa-camera-retro img-size"></i>
                                     <br />
                                     <!--AUI框架中的图标-->
                                   </span>
                                   <input name="passportphoto[]" value="1111" type="file" id="file" class="filepath" onchange="changepic(this)" accept="image/jpg,image/jpeg,image/png,image/PNG">
                                   <p>上传到达机票</p>
                                   </div>
                                  </div>
                                  <button id="finish" type="button" class="btn  btn-circle btn-success info-btn"><i class="fa fa-check"></i></button>
                              </div>

                              <div class="small mb-6 row-img over">
                                <div id="imgPreview">
                                   <div id="prompt3">
                                   <span id="imgSpan">
                                   <i class="fa fa-camera-retro img-size"></i>
                                     <br />
                                     <!--AUI框架中的图标-->
                                   </span>
                                   <input name="passportphoto[]" value="1111" type="file" id="file" class="filepath" onchange="changepic(this)" accept="image/jpg,image/jpeg,image/png,image/PNG">
                                   <p>上传返回机票</p>
                                   </div>
                                  </div>
                                  <button id="finish" type="button" class="btn  btn-circle btn-success info-btn"><i class="fa fa-check"></i></button>
                              </div>

                          </div>
                      </div>
                  </div>
                </div>

                <div class="col-lg-4">
                  <div class="card position-relative">
                      <div class="card-header py-3">
                          <h6 class="m-0 font-weight-bold text-primary">上传酒店信息</h6>
                      </div>
                      <div class="card-body">
                          <div class="row">
                              <div class="small mb-6 row-img over">
                                    <!-- <i class="fa fa-camera-retro img-size"></i><br/> -->
                                 <div id="imgPreview">
                                   <div id="prompt3">
                                   <span id="imgSpan">
                                   <i class="fa fa-camera-retro img-size"></i>
                                     <br />
                                     <!--AUI框架中的图标-->
                                   </span>
                                   <input name="passportphoto[]" value="aaa" type="file" id="file" class="filepath" onchange="changepic(this)" accept="image/jpg,image/jpeg,image/png,image/PNG">
                                   <p>上传酒店信息</p>
                                   </div>
                                  </div>
                                  <button id="finish" type="button" class="btn  btn-circle btn-success info-btn"><i class="fa fa-check"></i></button>
                              </div>

                          </div>
                      </div>
                  </div>
                </div>

            </div>
{#            <div style=" float: right; margin-top:1rem;">#}
{#              <a href="#" class="btn btn-success btn-icon-split"><span class="icon text-white-50"> <i class="fas fa-check"></i> </span>#}
{#                  <span class="text">全部上传</span>#}
{#              </a>#}
{#             </div>#}
        </div>
        <!-- 上传信息 end-->

        <div class="card-body">

            <div class="row">
                <!-- Grow In Utility -->
                <div class="col-lg-12">
                    <div class="card position-relative">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">请输入个人联系信息</h6>
                        </div>
                        <div class="card-body row">
                            <div class="col-sm-12 col-md-6 col-lg-3">
                                <label  >手机号码<br/><input id="name" name="Mobile number" type="text" placeholder="86+ 18636987415"></label>
                            </div>
                            <div class="col-sm-12 col-md-6 col-lg-3">
                                <label  >邮箱地址<br/>
                                    <input id="last_name" name="Email address" type="text" value="" placeholder="邮箱">
                                </label>
                            </div>
                            <div class="col-sm-12 col-md-6 col-lg-3">
                                <label>住址信息<br/>
                                    <textarea rows="1" cols="50"  placeholder="住址"></textarea>
                                </label>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <!-- 输入联系信息 end -->

        <div class="card-body">

            <div class="row">
                <!-- Grow In Utility -->
                <div class="col-lg-12">

                        <div class="card position-relative">
                            <div class="card-header py-3">
                                <h6 class="m-0 font-weight-bold text-primary">确认个人信息</h6>
                            </div>
                            <div class="card-body row">
                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label  >姓<br/> <!-- 姓 -->
                                      <input id="family Name" name="family Name" type="text" value="" placeholder="姓">
                                    </label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label >名<br/>  <!-- 名 -->
                                        <input id="first_name" name="first_name" type="text" value="" placeholder="名"></label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label >称谓<br/>  <!-- 称谓 -->
                                        <input id="salutation" name="salutation" type="text" value="" placeholder="称谓"></label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label >性别<br/>  <!-- 性别 -->
                                        <input id="gender" name="gender" type="text" value="" placeholder="性别"></label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label>出生日期<br/>  <!-- 出生日期 -->
                                    <input id="birth_date" name="birth_date" type="text" value="" placeholder="出生日期"></label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label>国籍<br/>  <!-- 国籍 -->
                                   <input id="nationality" name="nationality" type="text" value="" placeholder="国籍"></label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label>护照号<br/>  <!-- 护照号 -->
                                  <input id="passport_number" name="passport_number" type="text" value="" placeholder="护照号"></label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label>护照类型<br/>  <!-- 护照类型 -->
                                  <input id="passport type" name="passport type" type="text" value="" placeholder="护照类型"></label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label>签发日期<br/>  <!-- 签发日期 -->
                                  <input id="passport_issue" name="passport_issue" type="text" value="" placeholder="签发日期"></label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label>有效期至<br/>  <!-- 有效期至 -->
                                        <input id="passport_expiry" name="passport_expiry" type="text" value="" placeholder="有效期至"></label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label>到达机场<br/>  <!-- 到达机场 -->
                                        <input id="arrival airport" name="arrival airport" type="text" value="" placeholder="到达机场"></label>
                                </div>

                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label >到达日期<br/>  <!-- 到达日期 -->
                                        <input id="date-ortion" name="date-portion" type="text" value="" placeholder="到达日期">
                                    </label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label >到达时间<br/>  <!-- 到达时间 -->
                                        <input id="time-portion" name="time-portion" type="text" value="" placeholder="到达时间">
                                    </label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label >到达航班号<br/>  <!-- 到达航班号 -->
                                        <input id="arrival-no" name="arrival-no" type="text" value="" placeholder="到达航班号">
                                    </label>
                                </div>

                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label >离开日期<br/>  <!-- 离开日期 -->
                                        <input id="leave-Portion" name="date Portion" type="text" value="" placeholder="离开日期">
                                    </label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label >离开时间<br/>  <!-- 离开时间 -->
                                        <input id="leave-portion" name="leave-portion" type="text" value="" placeholder="离开时间">
                                    </label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-3">
                                    <label >离开航班号<br/>  <!-- 离开航班号 -->
                                        <input id="departure-no" name="departure-no" type="text" value="" placeholder="离开航班号">
                                    </label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-3"> <!-- 住宿类型 -->
                                    <label>住宿类型<br/>
                                   <input id="thailand" name="thailand" type="text" value="" placeholder="住宿类型"></label>
                                </div>



                            </div>
                        </div>

                </div>
            </div>
            <div style=" float: right; margin-top:1rem;">
              <a href="#" class="btn btn-success btn-icon-split"><span class="icon text-white-50"> <i class="fas fa-check"></i> </span>
                  <span class="text">确认提交</span>
              </a>
             </div>
        </div>
        <!-- 确认信息 end -->

      </div>
      <!-- End of Main Content -->

        </div>


    </div>
    {#    粘贴进来的文件end #}

{#    <input name="fi" type="file" value="aaa">#}
{#    <button name="bb" class="btn btn-danger up" onclick="f(this)">submit</button>#}

{% endblock %}
{% block js %}
    <script type="text/javascript">
        function f11(t) {
            let that = t;
            let f = $(that).parent().prev().children()[0];
            console.log($(that).parent().prev().children().first().val());
            console.log($(that).parent().prev().children()[0]);

            let file = f.files[0];
            if (!file) {
                alert("请先选择文件");
            }
            let formData = new FormData();
            formData.append('passport', file);
            console.log(formData);
            $.ajax({
                url: "/upload/",
                type: "post",
                data: formData,
                xhrFields: {withCredentials: true},
                contentType: false,
                processData: false,
                mimeType: "multipart/form-data",
                success: function (data) {
                    data = JSON.parse(data);
                    if (data.length != 8) {
                        console.log("识别失败，请重新拍摄照片，保持画面清晰。");
                        alert("识别失败，请重新拍摄照片，保持画面清晰。");
                    } else {
                        console.log("else");
                        // data = [ret.get("country"), firstname, lastname, ret.get("sex"), ret.get("birth_date"), ret.get("passport_no"),
                        //     ret.get("issue_date"),
                        //     ret.get("expiry_date")]
                        console.log(data);
                        // name="name" type="text" value="张三"></td>
                        //         <td><input name="last_name" type="text" value="张"></td>
                        //         <td><input name="first_name" type="text" value="三"></td>
                        //         <td><input name="salutation" type="text" value="女士"></td>
                        //         <td><input name="gender" type="text" value="女"></td>
                        //         <td><input name="birth_date" type="text" value="19/09/12"></td>
                        //         <td><input name="nationality" type="text" value="中国"></td>
                        //         <td><input name="passport_type" type="text" value="普通"></td>
                        //         <td><input name="passport_number" type="text" value="G890654356"></td>
                        //         <td><input name="passport_issue" type="text" value="12/09/14"></td>
                        //         <td><input name="passport_expiry
                        $("#name").val(data[2] + '.' + data[1]);
                        $("#last_name").val(data[2]);
                        $("#first_name").val(data[1]);
                        $("#salutation").val(data[3]);
                        $("#gender").val(data[3]);
                        $("#birth_date").val(data[4]);
                        $("#nationality").val(data[0]);
                        $("#passport_number").val(data[5]);
                        $("#passport_issue").val(data[6]);
                        $("#passport_expiry").val(data[7]);

                    }
                },
                error: function (data) {
                    console.log(data);
                }
            });


        }

        // 上传图片
        function f(btn) {
            let that = btn;
            console.log($(that));
            let file = $(that).prev()[0].files[0];
            let formData = new FormData();
            formData.append('passport', file);
            console.log(formData);
            $.ajax({
                url: "/upload/",
                type: "post",
                data: formData,
                xhrFields: {withCredentials: true},
                contentType: false,
                processData: false,
                mimeType: "multipart/form-data",
                success: function (data) {
                    data = JSON.parse(data);
                    if (data.length < 8) {
                        alert("识别失败，请重新拍摄照片，保持画面清晰。")
                    } else {
                        // data = [ret.get("country"), firstname, lastname, ret.get("sex"), ret.get("birth_date"), ret.get("passport_no"),
                        //     ret.get("issue_date"),
                        //     ret.get("expiry_date")]
                        console.log(data);
                        // name="name" type="text" value="张三"></td>
                        //         <td><input name="last_name" type="text" value="张"></td>
                        //         <td><input name="first_name" type="text" value="三"></td>
                        //         <td><input name="salutation" type="text" value="女士"></td>
                        //         <td><input name="gender" type="text" value="女"></td>
                        //         <td><input name="birth_date" type="text" value="19/09/12"></td>
                        //         <td><input name="nationality" type="text" value="中国"></td>
                        //         <td><input name="passport_type" type="text" value="普通"></td>
                        //         <td><input name="passport_number" type="text" value="G890654356"></td>
                        //         <td><input name="passport_issue" type="text" value="12/09/14"></td>
                        //         <td><input name="passport_expiry
                        $("#name").val(data[2] + '.' + data[1]);
                        $("#last_name").val(data[2]);
                        $("#first_name").val(data[1]);
                        $("#salutation").val(data[3]);
                        $("#gender").val(data[3]);
                        $("#birth_date").val(data[4]);
                        $("#nationality").val(data[0]);
                        $("#passport_number").val(data[5]);
                        $("#passport_issue").val(data[6]);
                        $("#passport_expiry").val(data[7]);

                    }
                },
                error: function (data) {
                    console.log(data);
                }
            });

        }

        function saveUser2() {
            var id = $("#id").val().trim();
            var uname = $("#uname").val().trim();
            var pwd = $("#pwd").val().trim();
            var file = document.getElementById("file").files[0];
            var formData = new FormData();
            formData.append('id', id);
            formData.append('uname', uname);
            formData.append('pwd', pwd);
            formData.append('file', file);

            $.ajax({
                url: "/home/about",
                type: "post",
                data: formData,
                contentType: false,
                processData: false,
                mimeType: "multipart/form-data",
                success: function (data) {
                    console.log(data);
                },
                error: function (data) {
                    console.log(data);
                }
            });
        }

    </script>
{% endblock %}